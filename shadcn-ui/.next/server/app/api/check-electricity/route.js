"use strict";(()=>{var e={};e.id=151,e.ids=[151],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},259:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>y,originalPathname:()=>k,patchFetch:()=>P,requestAsyncStorage:()=>h,routeModule:()=>p,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>m});var n={};r.r(n),r.d(n,{POST:()=>l});var a=r(9462),o=r(5345),s=r(7143),i=r(2969);let c=process.env.NEW_API_BASE_URL,u=process.env.NEW_API_PATH;async function l(e){try{let{contract_number:t,sku:r}=await e.json();if(!t||!r)return i.Z.json({error:"Thiếu contract_number hoặc sku"},{status:400});let n=new AbortController,a=setTimeout(()=>n.abort(),1e4);try{let e;let o=await fetch(new URL(u,c).toString(),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({contract_number:t,sku:r}),signal:n.signal});clearTimeout(a);let s=o.headers.get("content-type")||"",l=await o.text();if(!s.includes("application/json"))return i.Z.json({error:"Lỗi từ API Cổng 2 (7ty.vn)",details:l||"Phản hồi kh\xf4ng phải JSON"},{status:o.status});try{e=JSON.parse(l)}catch(e){return console.error("Lỗi parse JSON Cổng 2:",e,"Response text:",l),i.Z.json({error:"API Cổng 2 trả về JSON kh\xf4ng hợp lệ (c\xf3 thể l\xe0 rỗng)",details:e.message},{status:500})}return i.Z.json(e,{status:o.status})}finally{clearTimeout(a)}}catch(e){if(console.error("Error in /api/check-electricity:",e),"AbortError"===e.name||"ETIMEDOUT"===e.code)return i.Z.json({error:"Gateway Timeout (API Cổng 2 kh\xf4ng phản hồi)"},{status:504});return i.Z.json({error:e.message},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/check-electricity/route",pathname:"/api/check-electricity",filename:"route",bundlePath:"app/api/check-electricity/route"},resolvedPagePath:"/workspace/shadcn-ui/app/api/check-electricity/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:d,serverHooks:g,headerHooks:y,staticGenerationBailout:m}=p,k="/api/check-electricity/route";function P(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[120,971],()=>r(259));module.exports=n})();