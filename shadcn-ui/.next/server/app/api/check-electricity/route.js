"use strict";(()=>{var e={};e.id=151,e.ids=[151],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},259:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>d,originalPathname:()=>y,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>u,serverHooks:()=>h,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>g});var a={};r.r(a),r.d(a,{POST:()=>c});var n=r(9462),i=r(5345),o=r(7143),s=r(2969);async function c(e){try{let{contract_number:t,sku:r}=await e.json();if(!t||!r)return s.Z.json({error:"Thiếu contract_number hoặc sku"},{status:400});let a=new AbortController,n=setTimeout(()=>a.abort(),1e4);try{let e;let i=await fetch(new URL("/api/check-electricity","https://bill.7ty.vn").toString(),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({contract_number:t,sku:r}),signal:a.signal});clearTimeout(n);let o=i.headers.get("content-type")||"",c=await i.text();if(!o.includes("application/json"))return s.Z.json({error:"Lỗi từ API Cổng 2 (7ty.vn)",details:c||"Phản hồi kh\xf4ng phải JSON"},{status:i.status});try{e=JSON.parse(c)}catch(e){return console.error("Lỗi parse JSON Cổng 2:",e,"Response text:",c),s.Z.json({error:"API Cổng 2 trả về JSON kh\xf4ng hợp lệ (c\xf3 thể l\xe0 rỗng)",details:e.message},{status:500})}return s.Z.json(e,{status:i.status})}finally{clearTimeout(n)}}catch(e){if(console.error("Error in /api/check-electricity:",e),"AbortError"===e.name||"ETIMEDOUT"===e.code)return s.Z.json({error:"Gateway Timeout (API Cổng 2 kh\xf4ng phản hồi)"},{status:504});return s.Z.json({error:e.message},{status:500})}}let u=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/check-electricity/route",pathname:"/api/check-electricity",filename:"route",bundlePath:"app/api/check-electricity/route"},resolvedPagePath:"/workspace/shadcn-ui/app/api/check-electricity/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:h,headerHooks:d,staticGenerationBailout:g}=u,y="/api/check-electricity/route";function m(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:p})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[120,971],()=>r(259));module.exports=a})();