"use strict";(()=>{var e={};e.id=151,e.ids=[151],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},259:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>k,originalPathname:()=>x,patchFetch:()=>f,requestAsyncStorage:()=>y,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>j});var n={};r.r(n),r.d(n,{POST:()=>h,dynamic:()=>l,runtime:()=>p});var a=r(9462),i=r(5345),s=r(7143),o=r(2969),c=r(6797),u=r(8165);let l="force-dynamic",p="nodejs";async function h(e){if(!(0,c.cookies)().get("session"))return o.Z.json({error:"Chưa đăng nhập"},{status:401});try{let t;let{contract_number:r,sku:n}=await e.json();if(!r||!n)return o.Z.json({error:"Thiếu contract_number hoặc sku"},{status:400});let a="https://bill.7ty.vn",i="/api/check-electricity";if(!a||!i)return o.Z.json({error:"Thiếu cấu h\xecnh API Gateway 2"},{status:500});let s=new URL(i,a).toString(),c=await (0,u.kv)(s,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({contract_number:r,sku:n})}),l=c.headers.get("content-type")||"",p=await c.text();if(!l.includes("application/json"))return o.Z.json({error:"Lỗi từ API Gateway 2 (7ty.vn)",details:p||"Phản hồi kh\xf4ng phải JSON"},{status:c.status});try{t=JSON.parse(p)}catch(e){return o.Z.json({error:"API Gateway 2 trả về JSON kh\xf4ng hợp lệ",details:"Lỗi parse JSON"},{status:500})}return o.Z.json(t,{status:c.status})}catch(e){if(console.error("Error in /api/check-electricity:",e),"AbortError"===e.name||"ETIMEDOUT"===e.code)return o.Z.json({error:"Gateway Timeout (API Gateway 2 kh\xf4ng phản hồi)"},{status:504});return o.Z.json({error:e.message||"Lỗi kh\xf4ng x\xe1c định"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/check-electricity/route",pathname:"/api/check-electricity",filename:"route",bundlePath:"app/api/check-electricity/route"},resolvedPagePath:"/workspace/shadcn-ui/app/api/check-electricity/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:y,staticGenerationAsyncStorage:g,serverHooks:m,headerHooks:k,staticGenerationBailout:j}=d,x="/api/check-electricity/route";function f(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}},8165:(e,t,r)=>{r.d(t,{cn:()=>i,kv:()=>s});var n=r(4121),a=r(5497);function i(...e){return(0,a.m6)((0,n.W)(e))}async function s(e,t,r=1e4){let n=new AbortController,a=setTimeout(()=>n.abort(),r);try{return await fetch(e,{...t,signal:n.signal})}finally{clearTimeout(a)}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[472,578,898],()=>r(259));module.exports=n})();